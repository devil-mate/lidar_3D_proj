<?xml version="1.0"?>
<launch>

    <arg name="id_robot" default="robot"/>
    <arg name="prefix" default="$(arg id_robot)_"/>
    <arg name="x_init_pose" default="0"/>
    <arg name="y_init_pose" default="0"/>
    <arg name="z_init_pose" default="0"/>
    <arg name="xacro_robot_package" default="summit_xl_description"/>
    <arg name="xacro_robot" default="summit_xl_std.urdf.xacro"/>
    <arg name="xacro_robot_path" default="$(eval find(xacro_robot_package) + '/robots/' + xacro_robot)"/>
    <arg name="launch_amcl_and_mapserver" default="false"/>
    <arg name="dataFusion" default="true"/> 
    <arg name="launch_gmapping" default="true"/>
    <arg name="launch_move_base" default="true"/>
    <arg name="launch_robot_ekf_localization" default="false"/>
    <arg name="robot_ekf_localization_mode" default="odom"/>
    <arg name="map_file" default="empty/empty.yaml"/>
    <arg name="movebase_local_planner" default="teb"/>
    
    <!-- odom, complete (including gps)-->
    <arg name="omni_drive" default="false"/>
    <arg name="ros_planar_move_plugin" default="false"/>
    <arg name="launch_pad" default="false"/>
    <arg name="use_gpu_for_simulation" default="false"/><!-- use_gpu_for_simulation -->
    <arg name="has_pantilt_camera" default="false"/>
    <!-- arm robot -->
    <arg name="launch_arm" default="false"/>
    <arg name="arm_manufacturer" default="trossen"/>
	<arg name="arm_model" default="vx300s"/>
    <arg name="launch_moveit" default="false"/>
    <arg name="arm_prefix" default="$(arg prefix)$(arg arm_model)"/>

    <!-- only for advanced simulation -->
    <arg name="launch_advanced_simulation" default="false"/> <!-- one flag activates all -->
    <arg name="launch_base_hw_sim" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_battery_estimator" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_perception" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_navigation" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_rlc" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_rlc_rostful" default="$(arg launch_advanced_simulation)"/>
    <arg name="launch_hmi" default="$(arg launch_advanced_simulation)"/>
    <arg name="rlc_rostful_host" default="localhost"/>
    <arg name="rlc_rostful_port" default="8080"/>
    <arg name="merge_lasers" default="$(arg launch_advanced_simulation)"/>
    <arg name="merge_laser_topics" default="front_laser/scan rear_laser/scan"/>

    <!-- GPS default position of Robotnik at Fuente del Jarro-->
	<arg name="gps_latitude" default="39.5080331"/>
	<arg name="gps_longitude" default="-0.4619816"/>

    <group ns="$(arg id_robot)">

        <include file="$(find summit_xl_gazebo)/launch/sxl_navigation_base.launch">
            <arg name="merge_lasers" default="$(arg merge_lasers)"/>
            <arg name="launch_gmapping" default="$(arg launch_gmapping)"/>
            <arg name="launch_move_base" default="$(arg launch_move_base)"/>
            <arg name="launch_amcl_and_mapserver" default="$(arg launch_amcl_and_mapserver)"/>
        </include>


        <!-- \\\\\\\\\\\\\\\\\other\\\\\\\\\\\\\ -->
        <!-- start summit_xl_pad nodes -->
        <include if="$(arg launch_pad)" file="$(find robotnik_pad)/launch/robotnik_pad.launch">
            <arg name="pad_model" value="$(arg pad_model)"/>
        </include>

        <!-- base_hw_sim -->
        <include if="$(arg launch_base_hw_sim)" file="$(find robotnik_base_hw_sim)/launch/summit_xl_hw_sim.launch">
            <arg name="prefix" value="$(arg prefix)"/>
        </include>

        <group if="$(arg launch_battery_estimator)">
            <!-- start dock_manager node -->
            <include file="$(find charge_manager)/launch/charge_manager.launch">
                <arg name="docker_mode" value="manual_sw"/>
                <arg name="inverted_contact_relay_input" value="false"/>
                <arg name="contact_relay_input_number" value="2"/>
                <arg name="charger_relay_output_number" value="1"/>
            </include>

            <!-- start battery_estimation node -->
            <include file="$(find battery_estimation)/launch/table_battery.launch">
                <arg name="battery_voltage" value="48"/>
                <arg name="read_voltage_from_analog_input" value="true"/>
                <arg name="voltage_analog_input_number" value="1" />
                <arg name="current_analog_input_number" value="2" />
            </include>

        </group>


        <!-- MoveGroup Moveit! -->
        <include if="$(arg launch_moveit)" file="$(find summit_xl_j2s7s300_moveit_config)/launch/summit_xl_j2s7s300_moveit_config.launch">
                <!--arg name="sim" value="true"/-->
        </include>

    </group>
<!--
    <include if="$(arg launch_perception)" file="$(find summit_xl_perception)/launch/perception_complete.launch">
        <arg name="id_robot" value="$(arg id_robot)"/>
        <arg name="run_reflector_locator" value="true"/>
        <arg name="run_ar_locator" value="true"/>
    </include>
 -->
    <!-- <include if="$(arg launch_navigation)" file="$(find summit_xl_navigation)/launch/navigation_complete.launch">
        <arg name="id_robot" value="$(arg id_robot)"/>
        <arg name="has_docker" value="true"/>
        <arg name="run_laser_docker" value="true"/>
    </include> -->
<!--
    <group if="$(arg launch_rlc)">

        <include file="$(find summit_xl_robot_local_control)/launch/robot_local_control.launch">
            <arg name="id_robot" value="$(arg id_robot)"/>
        </include>


        <include if="$(arg launch_rlc_rostful)" file="$(find summit_xl_robot_local_control)/launch/rostful_server.launch">
            <arg name="id_robot" value="$(arg id_robot)"/>
            <arg name="host" value="$(arg rlc_rostful_host)"/>
            <arg name="port" value="$(arg rlc_rostful_port)"/>
        </include>

    </group>
-->
    <include if="$(arg launch_hmi)" file="$(find robotnik_hmi)/launch/robotnik_hmi.launch">
        <arg name="id_robot" value="$(arg id_robot)"/>
        <arg name="launch_system_monitor" value="false"/>
    </include>


</launch>
